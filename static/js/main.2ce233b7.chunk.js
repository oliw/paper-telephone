(this["webpackJsonppaper-telephone"]=this["webpackJsonppaper-telephone"]||[]).push([[0],{46:function(e,a,t){e.exports=t(89)},51:function(e,a,t){},85:function(e,a){},89:function(e,a,t){"use strict";t.r(a);var n=t(0),r=t.n(n),l=t(42),i=t.n(l),o=(t(51),t(2)),c=t(7),m=function e(a){Object(c.a)(this,e),this.number=a,this.writing=null,this.drawing=null,this.author=null};function u(e){return null!=e.drawing||null!=e.writing}function s(e,a){return!(a<0||a>=e.entries.length)&&u(e.entries[a])}var d=function e(a,t){Object(c.a)(this,e),this.player=a,this.entries=Array(t).fill(null);for(var n=0;n<t;n++)this.entries[n]=new m(n)};var p={name:"paper-telephone",setup:function(e){for(var a=e.numPlayers,t=a,n=Array(a),r={},l=0;l<a;l++)n[l]=new d(l,t),r["".concat(l)]=l;return{papers:n,numberOfRounds:t,currentSubmissionMethod:null,playerIdsToPaperIdx:r}},turn:{onBegin:function(e,a){e.currentSubmissionMethod=a.turn%2===0?"draw":"write"},onEnd:function(e,a){var t=a.numPlayers,n=e.playerIdsToPaperIdx,r={};return Object.keys(n).forEach((function(e){var a=n[e],l=(t+a-1)%t;r[e]=l})),Object(o.a)({},e,{playerIdsToPaperIdx:r})},endIf:function(e,a){var t=a.turn;return e.papers.every((function(e){return s(e,t-1)}))},activePlayers:{all:"submit",moveLimit:1},stages:{submit:{moves:{SubmitWriting:function(e,a,t){var n=a.playerID,r=a.turn,l=e.playerIdsToPaperIdx[n];e.papers[l].entries[r-1]=Object(o.a)({},e.papers[l].entries[r-1],{writing:t,author:n})},SubmitDrawing:function(e,a,t){var n=a.playerID,r=a.turn,l=e.playerIdsToPaperIdx[n];e.papers[l].entries[r-1]=Object(o.a)({},e.papers[l].entries[r-1],{drawing:t,author:n})}}}}},moves:{},endIf:function(e){var a=e.numberOfRounds;return e.papers.every((function(e){return s(e,a-1)}))?{}:null},minPlayers:2,maxPlayers:10},h=t(6),b=t(1),f="#ffffff",v="#bbded6",g="750px",E="18pt",y=b.a.create({main:{height:"30px",borderRadius:"10px",fontWeight:"bold",borderColor:v,borderWidth:"2px",outline:"none"},primary:{backgroundColor:v,color:f},secondary:{color:v}});function w(e){var a=e.onClick,t=e.children,n=e.type,l="primary"===n,i="primary"!==n;return r.a.createElement("button",{className:Object(b.b)(y.main,l&&y.primary,i&&y.secondary),onClick:a},t)}var x=b.a.create({container:{display:"flex",flexDirection:"column",alignItems:"center"},canvas:{display:"none"},buttonsContainer:{display:"flex"}});var j=function(e){var a=e.onImageSelected,t=e.previousPhrase,l=Object(n.useRef)(null),i=Object(n.useRef)(null),o=Object(n.useState)(null),c=Object(h.a)(o,2),m=c[0],u=c[1];return Object(n.useEffect)((function(){l&&!m&&navigator.mediaDevices.getUserMedia({video:!0}).then((function(e){var a=l.current;a.srcObject=e,a.play()}))}),[l,m]),r.a.createElement("div",{className:Object(b.b)(x.container)},r.a.createElement("div",{className:Object(b.b)(x.header)},r.a.createElement("p",null,"Time to draw!")),r.a.createElement("div",{className:Object(b.b)(x.promptContainer)},r.a.createElement("p",null,"Can you draw this phrase and take a picture of it?"),r.a.createElement("p",null,t)),r.a.createElement("div",{className:Object(b.b)(x.drawingContainer)},!m&&r.a.createElement(r.a.Fragment,null,r.a.createElement("video",{ref:l,autoPlay:!0}),r.a.createElement("canvas",{className:Object(b.b)(x.canvas),ref:i,width:640,height:480})),m&&r.a.createElement("img",{src:m,alt:"Foo"})),r.a.createElement("div",{className:Object(b.b)(x.buttonsContainer)},!m&&r.a.createElement(w,{type:"primary",onClick:function(){i.current.getContext("2d").drawImage(l.current,0,0,i.current.width,i.current.height),u(i.current.toDataURL("image/jpeg"))}},"Take picture"),m&&r.a.createElement(w,{type:"primary",onClick:function(){a&&a(m)}},"Submit"),m&&r.a.createElement(w,{onClick:function(){return u(null)}},"Take a different picture")))},O=b.a.create({container:{display:"flex",flexDirection:"column"},input:{fontSize:E,marginBottom:"10px"}});var C=function(e){var a=e.onPhraseChosen,t=e.previousDrawingUri,n=r.a.useState(""),l=Object(h.a)(n,2),i=l[0],o=l[1],c=null==t,m=c?"Lets Begin!":"Guess that phrase!",u=c?"Enter a phrase that the next person will have to draw out.":"Take a look at the picture that the person before you drew. What do you think the word or phrase is?";return r.a.createElement("div",{className:Object(b.b)(O.container)},r.a.createElement("p",null,m),t&&r.a.createElement("img",{src:t,width:"640",height:"480",alt:"Foo"}),r.a.createElement("p",null,u),r.a.createElement("input",{className:Object(b.b)(O.input),type:"text",placeholder:"Enter a phrase here",value:i,onChange:function(e){o(e.target.value)}}),r.a.createElement(w,{type:"primary",onClick:function(){a(i)}},"Submit"))},N=b.a.create({card:{width:g,backgroundColor:"white",padding:"25px",borderWidth:"2px",borderRadius:"25px",borderColor:v,borderStyle:"solid"}});function k(e){var a=e.children;return r.a.createElement("div",{className:Object(b.b)(N.card)},a)}b.a.create({text:{fontFamily:["Fredoka One","cursive"],color:v,padding:0,margin:0}});function I(e){var a=e.entry,t=e.first;return r.a.createElement("div",null,r.a.createElement("p",null,t?"First":"Then"," ",a.author," wrote"),r.a.createElement("p",null,a.writing))}function S(e){var a=e.entry;e.first;return r.a.createElement("div",null,r.a.createElement("p",null,"Then ",a.author," drew"),r.a.createElement("img",{src:a.drawing,width:"640",height:"480",alt:"Foo"}))}function P(e){var a=e.paper.entries.map((function(e,a){return a%2===0?r.a.createElement(I,{key:a,entry:e,first:0==a}):r.a.createElement(S,{key:a,entry:e,first:0==a})}));return r.a.createElement("div",null,r.a.createElement("p",null,"Heres what paper looked like"),a)}function R(e){var a=e.game,t=r.a.useState(0),n=Object(h.a)(t,2),l=n[0],i=n[1],o=a.papers[l];return r.a.createElement("div",null,r.a.createElement(k,null,r.a.createElement("p",null,"Its the end of the game!"),r.a.createElement("p",null,"Lets take a look at what everybody wrote and drew"),r.a.createElement("button",{onClick:function(){i((a.papers.length+l-1)%a.papers.length)}},"Back"),r.a.createElement("button",{onClick:function(){i((l+1)%a.papers.length)}},"Next Thread")),r.a.createElement(k,null,r.a.createElement(P,{paper:o})))}var D=b.a.create({container:{width:"100%",minHeight:"100%",position:"absolute",backgroundColor:v,display:"flex",justifyContent:"center",paddingTop:"15px"},innerContainer:{display:"flex",flexDirection:"column"},main:{flexGrow:1},cardContainer:{marginTop:"35px"}});var G=function(e){var a=e.moves,t=(e._,e.G),n=e.ctx,l=e.playerID;if(n.gameover)return r.a.createElement("div",{className:Object(b.b)(D.container)},r.a.createElement("div",{className:Object(b.b)(D.innerContainer)},r.a.createElement("div",{className:Object(b.b)(D.cardContainer)},r.a.createElement(R,{game:t}))));if(!l)return r.a.createElement("div",{className:Object(b.b)(D.container)},r.a.createElement("div",{className:Object(b.b)(D.innerContainer)},r.a.createElement("div",{className:Object(b.b)(D.cardContainer)},r.a.createElement(k,null,r.a.createElement("h1",null,"Unknown Player")))));var i=t.playerIdsToPaperIdx[l],o=t.papers[i].entries.slice().reverse().find((function(e){return u(e)})),c=null,m=null;return o&&"write"===t.currentSubmissionMethod&&(c=o.drawing),o&&"draw"===t.currentSubmissionMethod&&(m=o.writing),r.a.createElement("div",{className:Object(b.b)(D.container)},r.a.createElement("div",{className:Object(b.b)(D.innerContainer)},r.a.createElement("div",{className:Object(b.b)(D.cardContainer)},r.a.createElement(k,null,r.a.createElement("div",{className:Object(b.b)(D.details)},r.a.createElement("p",null,"The current turn is: ",n.turn,", which means its time to:"," ",t.currentSubmissionMethod),r.a.createElement("p",null,"There are ",n.numPlayers," players. You are player ",l)))),r.a.createElement("div",{className:Object(b.b)(D.cardContainer)},r.a.createElement(k,null,r.a.createElement("div",{className:Object(b.b)(D.main)},"write"===t.currentSubmissionMethod&&n.activePlayers[l]&&r.a.createElement(C,{onPhraseChosen:function(e){a.SubmitWriting(e)},previousDrawingUri:c}),"draw"===t.currentSubmissionMethod&&n.activePlayers[l]&&r.a.createElement(j,{onImageSelected:function(e){a.SubmitDrawing(e)},previousPhrase:m}),!n.activePlayers[l]&&r.a.createElement("p",null,"Waiting for others to finish their move"))))))},T=b.a.create({container:{height:"100%"},mainContainer:{flexGrow:"1"},headerContainer:{display:"flex",flexDirection:"row",justifyContent:"center",width:"100%",padding:"3px"},headerLeft:{flex:1,textAlign:"left"},headerMiddle:{flex:1,textAlign:"center"},headerRight:{flex:1,textAlign:"right"}});function L(e){var a=e.runningRoom,t=e.playerName,n=e.handleExitRoom;if(!a)return r.a.createElement("p",null,"Please wait");var l="paper-telephone"===a.gameName?"Paper Telephone":"Unknown Game";return r.a.createElement("div",{className:Object(b.b)(T.headerContainer)},r.a.createElement("div",{className:Object(b.b)(T.headerLeft)},r.a.createElement("button",{onClick:function(){n()}},"Leave and return to Lobby")),r.a.createElement("div",{className:Object(b.b)(T.headerMiddle)},"Now playing: ",l),r.a.createElement("div",{className:Object(b.b)(T.headerRight)},"Playing as: ",t))}function M(e){var a=e.runningGame,t=e.rooms,n=e.playerName,l=e.handleExitRoom,i=t.find((function(e){return e.gameID===a.gameID}));return r.a.createElement("div",null,r.a.createElement(L,{runningGame:a,runningRoom:i,playerName:n,handleExitRoom:l}),r.a.createElement(a.app,{gameID:a.gameID,playerID:a.playerID,credentials:a.credentials}))}var W=t(5),A=b.a.create({container:{textAlign:"center"},icon:{},text:{padding:0,margin:0}});function B(e){var a=e.name,t=function(e){for(var a=0,t=0;t<e.length;t++)a=e.charCodeAt(t)+((a<<5)-a);for(var n="#",r=0;r<3;r++){n+=("00"+(a>>8*r&255).toString(16)).substr(-2)}return n}(a);return r.a.createElement("div",{className:Object(b.b)(A.container)},r.a.createElement("svg",{className:Object(b.b)(A.icon),width:"1em",height:"1em",viewBox:"0 0 16 16",fill:t,xmlns:"http://www.w3.org/2000/svg"},r.a.createElement("path",{fillRule:"evenodd",d:"M3 14s-1 0-1-1 1-4 6-4 6 3 6 4-1 1-1 1H3zm5-6a3 3 0 100-6 3 3 0 000 6z",clipRule:"evenodd"})),r.a.createElement("p",{className:Object(b.b)(A.text),style:{color:"".concat(t)}},a))}var F=b.a.create({container:{height:"100%",display:"flex",flexDirection:"column"},mainContainer:{flexGrow:"1",width:"100%",minHeight:"100%",backgroundColor:v,paddingTop:"15px",display:"flex",flexDirection:"column",alignItems:"center"},seatedPlayers:{display:"flex",alignItems:"center"},seatedPlayersLabel:{marginRight:"10px"},seatedPlayerIcon:{marginRight:"10px"},game:{borderRadius:"10px",borderStyle:"solid",borderColor:v,borderWidth:"2px",padding:"10px"},gameContainer:{marginBottom:"10px"}});function J(e){var a=e.onEnter,t=r.a.useState(""),n=Object(h.a)(t,2),l=n[0],i=n[1];return r.a.createElement("div",null,r.a.createElement("p",null,"Choose a player name:"),r.a.createElement("input",{type:"text",value:l,onChange:function(e){i(e.target.value)}}),r.a.createElement("span",{className:"buttons"},r.a.createElement("button",{className:"buttons",onClick:function(){""!==l&&(i(""),a(l))}},"Enter")))}function U(e){var a=e.rooms,t=e.playerName,n=e.handleJoinRoom,l=e.handleLeaveRoom,i=e.handleStartGame,o=e.handleRequestNewGame,c=a.map((function(e){return r.a.createElement("div",{key:e.gameID,className:Object(b.b)(F.gameContainer)},r.a.createElement(H,{room:e,playerName:t,handleJoinRoom:n,handleLeaveRoom:l,handleStartGame:i}))}));return r.a.createElement("div",null,r.a.createElement("p",null,"Choose from ",a.length," existing games"),c,r.a.createElement("p",null,"Or..Don't see a game to join?"," ",r.a.createElement("button",{onClick:o},"Host a new game")))}function H(e){var a=e.room,t=e.playerName,n=e.handleJoinRoom,l=e.handleLeaveRoom,i=e.handleStartGame,o=a.gameID,c=a.gameName,m=a.players,u=(m.map((function(e){return e.name})).join(","),m.find((function(e){return e.name===t}))),s=null!=u,d=m.find((function(e){return!e.name})),p=m.filter((function(e){return!e.name})),h=null!=d,f=!s&&h,v=s,g=s&&!h,E=m.map((function(e){return e.name})).filter((function(e){return null!=e})).map((function(e){return r.a.createElement("div",{className:Object(b.b)(F.seatedPlayerIcon)},r.a.createElement(B,{name:e,key:e}))})),y="paper-telephone"===c?"Telephone":"Unknown Game";return r.a.createElement("div",{className:Object(b.b)(F.game)},r.a.createElement("p",null,y),r.a.createElement("div",{className:Object(b.b)(F.seatedPlayers)},r.a.createElement("p",{className:Object(b.b)(F.seatedPlayersLabel)},"Players:"),E),h&&r.a.createElement("p",null,"Waiting for ",p.length," more players to take a seat"),f&&r.a.createElement("button",{onClick:function(){n(c,o,""+d.id)}},"Take a Seat"),g&&r.a.createElement("div",null,r.a.createElement("p",null,"Everyone is sat down!"),r.a.createElement("button",{onClick:function(){i(c,{gameID:o,playerID:""+u.id,numPlayers:m.length})}},"Enter the game")),v&&r.a.createElement("button",{onClick:function(){l(c,o)}},"Leave"))}function z(e){var a=e.games,t=e.createGame,n=e.onDismiss,l=r.a.useState(a[0]),i=Object(h.a)(l,2),o=i[0],c=i[1],m=r.a.useState(2),u=Object(h.a)(m,2),s=u[0],d=u[1],p=o?o.game.name:"--",b=a.map((function(e){return r.a.createElement("option",{key:e.game.name,value:e.game.name},e.game.name)}));return r.a.createElement("div",null,r.a.createElement("p",null,"Lets create a new game"),r.a.createElement("p",null,"Which game do you want to play?"),r.a.createElement("select",{value:p,onChange:function(e){var t=e.target.value;if(""!==t){var n=a.find((function(e){return e.game.name===t}));c(n)}else c(null)}},r.a.createElement("option",{value:""},"Select Game"),b),r.a.createElement("p",null,"And how many players?"),r.a.createElement("select",{value:s,onChange:function(e){var a=e.target.value;d(a)}},function(e){return Object(W.a)(new Array(e.game.maxPlayers+1).keys()).slice(e.game.minPlayers)}(o).map((function(e){return r.a.createElement("option",{key:"num-option-"+e,value:e},e)}))),r.a.createElement("button",{onClick:function(){t(p,s),n()}},"Create"))}function q(e){e.errorMsg;var a=e.gameComponents,t=e.rooms,n=(e.phase,e.playerName),l=(e.runningGame,e.handleEnterLobby),i=(e.handleExitLobby,e.handleCreateRoom),o=e.handleJoinRoom,c=e.handleLeaveRoom,m=(e.handleExitRoom,e.handleRefreshRooms,e.handleStartGame),u=r.a.useState(null==n),s=Object(h.a)(u,2),d=s[0],p=s[1],f=r.a.useState(!1),v=Object(h.a)(f,2),g=v[0],E=v[1];return r.a.createElement("div",{className:Object(b.b)(F.container)},r.a.createElement("div",{className:Object(b.b)(F.mainContainer)},r.a.createElement(k,null,r.a.createElement("p",null,"Hi ",n||"",", Welcome to the Paper Gamer Lobby!"),!d&&r.a.createElement("button",{onClick:function(){return p(!0)}},"Change Name"),d&&r.a.createElement(J,{onEnter:function(e){p(!1),l(e)}})),r.a.createElement(k,null,r.a.createElement(U,{rooms:t,playerName:n,handleJoinRoom:o,handleLeaveRoom:c,handleStartGame:m,handleRequestNewGame:function(){return E(!0)}})),g&&r.a.createElement(k,null,r.a.createElement(z,{games:a,createGame:i,onDismiss:function(){return E(!1)}}))))}var Y=b.a.create({container:{height:"100%"}});function $(e){var a=e.runningGame;return r.a.createElement("div",{className:Object(b.b)(Y.container)},a&&r.a.createElement(M,e),!a&&r.a.createElement(q,e))}var _=b.a.create({text:{fontFamily:["Fredoka One","cursive"],color:v,padding:0,margin:0}});function K(){return r.a.createElement("div",null,r.a.createElement("h1",{className:Object(b.b)(_.text)},"Paper Gamer"))}var Q=b.a.create({container:{width:"100%",display:"flex",justifyContent:"center",paddingTop:"4px",paddingBottom:"4px",backgroundColor:f}});var V=function(){return r.a.createElement("div",{className:Object(b.b)(Q.container)},r.a.createElement(K,null))},X=t(44),Z=b.a.create({container:{position:"absolute",width:"100%",height:"100%",display:"flex",flexDirection:"column"},header:{},main:{flexGrow:1,display:"relative"}}),ee=[{game:p,board:G}];var ae=function(){return r.a.createElement("div",{className:Object(b.b)(Z.container)},r.a.createElement("div",{className:Object(b.b)(Z.header)},r.a.createElement(V,null)),r.a.createElement("div",{className:Object(b.b)(Z.main)},r.a.createElement(X.a,{gameServer:"https://games-server.oliverwilkie.com",lobbyServer:"https://games-server.oliverwilkie.com",gameComponents:ee,renderer:$})))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));i.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(ae,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[46,1,2]]]);
//# sourceMappingURL=main.2ce233b7.chunk.js.map